<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cvBlobsLib: D:/users/ricard/src/utilitats/cpp/cvblobslib/BlobResult.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>D:/users/ricard/src/utilitats/cpp/cvblobslib/BlobResult.cpp</h1><a href="_blob_result_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">                        BlobResult.cpp</span>
<a name="l00003"></a>00003 <span class="comment">                        </span>
<a name="l00004"></a>00004 <span class="comment">FUNCIONALITAT: Implementació de la classe CBlobResult</span>
<a name="l00005"></a>00005 <span class="comment">AUTOR: Inspecta S.L.</span>
<a name="l00006"></a>00006 <span class="comment">MODIFICACIONS (Modificació, Autor, Data):</span>
<a name="l00007"></a>00007 <span class="comment"> </span>
<a name="l00008"></a>00008 <span class="comment">**************************************************************************/</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;limits.h&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;functional&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include "<a class="code" href="_blob_result_8h.html">BlobResult.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include "<a class="code" href="_blob_extraction_8h.html">BlobExtraction.h</a>"</span>
<a name="l00016"></a>00016 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span><span class="preprocessor">        #include &lt;afx.h&gt;</span>                        <span class="comment">//suport per a CStrings</span>
<a name="l00018"></a>00018 <span class="preprocessor">        #include &lt;afxwin.h&gt;</span>                     <span class="comment">//suport per a AfxMessageBox</span>
<a name="l00019"></a>00019 <span class="preprocessor">#endif</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span>
<a name="l00021"></a>00021 <span class="comment">/**************************************************************************</span>
<a name="l00022"></a>00022 <span class="comment">                Constructors / Destructors</span>
<a name="l00023"></a>00023 <span class="comment">**************************************************************************/</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00048"></a><a class="code" href="class_c_blob_result.html#a32d5d4037eff124d5f75084299e3d7a">00048</a> <a class="code" href="class_c_blob_result.html#a32d5d4037eff124d5f75084299e3d7a">CBlobResult::CBlobResult</a>()
<a name="l00049"></a>00049 {
<a name="l00050"></a>00050         <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a> = <a class="code" href="_blob_result_8h.html#5e6fa400c06a413a41414d2e8cea63c8">blob_vector</a>();
<a name="l00051"></a>00051 }
<a name="l00052"></a>00052 
<a name="l00089"></a><a class="code" href="class_c_blob_result.html#1ecc9689e2c57be5b14e32461a1224b8">00089</a> <a class="code" href="class_c_blob_result.html#a32d5d4037eff124d5f75084299e3d7a">CBlobResult::CBlobResult</a>(IplImage *source, IplImage *mask, <span class="keywordtype">int</span> threshold, <span class="keywordtype">bool</span> findmoments)
<a name="l00090"></a>00090 {
<a name="l00091"></a>00091         <span class="keywordtype">bool</span> success;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093         <span class="keywordflow">try</span>
<a name="l00094"></a>00094         {
<a name="l00095"></a>00095                 <span class="comment">// cridem la funció amb el marc a true=1=blanc (així no unirà els blobs externs)</span>
<a name="l00096"></a>00096                 success = <a class="code" href="_blob_extraction_8cpp.html#bbb3994a7c0e57dfb7a5b704b1d02882">BlobAnalysis</a>(source,(uchar)threshold,mask,<span class="keyword">true</span>,findmoments, <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a> );
<a name="l00097"></a>00097         }
<a name="l00098"></a>00098         <span class="keywordflow">catch</span>(...)
<a name="l00099"></a>00099         {
<a name="l00100"></a>00100                 success = <span class="keyword">false</span>;
<a name="l00101"></a>00101         }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         <span class="keywordflow">if</span>( !success ) <span class="keywordflow">throw</span> <a class="code" href="_blob_result_8h.html#543a8f8903504a326c779b528a39ef39">EXCEPCIO_CALCUL_BLOBS</a>;
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00130"></a><a class="code" href="class_c_blob_result.html#231c31a05f42508968da3b9e3df755ce">00130</a> <a class="code" href="class_c_blob_result.html#a32d5d4037eff124d5f75084299e3d7a">CBlobResult::CBlobResult</a>( <span class="keyword">const</span> <a class="code" href="class_c_blob_result.html">CBlobResult</a> &amp;source )
<a name="l00131"></a>00131 {
<a name="l00132"></a>00132         <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a> = <a class="code" href="_blob_result_8h.html#5e6fa400c06a413a41414d2e8cea63c8">blob_vector</a>( source.<a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() );
<a name="l00133"></a>00133         
<a name="l00134"></a>00134         <span class="comment">// creem el nou a partir del passat com a paràmetre</span>
<a name="l00135"></a>00135         <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a> = <a class="code" href="_blob_result_8h.html#5e6fa400c06a413a41414d2e8cea63c8">blob_vector</a>( source.<a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() );
<a name="l00136"></a>00136         <span class="comment">// copiem els blobs de l'origen a l'actual</span>
<a name="l00137"></a>00137         blob_vector::const_iterator pBlobsSrc = source.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin();
<a name="l00138"></a>00138         blob_vector::iterator pBlobsDst = m_blobs.begin();
<a name="l00139"></a>00139 
<a name="l00140"></a>00140         <span class="keywordflow">while</span>( pBlobsSrc != source.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.end() )
<a name="l00141"></a>00141         {
<a name="l00142"></a>00142                 <span class="comment">// no podem cridar a l'operador = ja que blob_vector és un </span>
<a name="l00143"></a>00143                 <span class="comment">// vector de CBlob*. Per tant, creem un blob nou a partir del</span>
<a name="l00144"></a>00144                 <span class="comment">// blob original</span>
<a name="l00145"></a>00145                 *pBlobsDst = <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>(**pBlobsSrc);
<a name="l00146"></a>00146                 pBlobsSrc++;
<a name="l00147"></a>00147                 pBlobsDst++;
<a name="l00148"></a>00148         }
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 
<a name="l00174"></a><a class="code" href="class_c_blob_result.html#aaf8d7cc9de99ea8284d7be1ddb1e712">00174</a> <a class="code" href="class_c_blob_result.html#aaf8d7cc9de99ea8284d7be1ddb1e712">CBlobResult::~CBlobResult</a>()
<a name="l00175"></a>00175 {
<a name="l00176"></a>00176         <a class="code" href="class_c_blob_result.html#a926243bae6148e765f8a4055ef42ce0">ClearBlobs</a>();
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="comment">/**************************************************************************</span>
<a name="l00180"></a>00180 <span class="comment">                Operadors / Operators</span>
<a name="l00181"></a>00181 <span class="comment">**************************************************************************/</span>
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 
<a name="l00206"></a><a class="code" href="class_c_blob_result.html#a833c008cc7056576a7cbd260d09f10c">00206</a> <a class="code" href="class_c_blob_result.html">CBlobResult</a>&amp; <a class="code" href="class_c_blob_result.html#a833c008cc7056576a7cbd260d09f10c">CBlobResult::operator=</a>(<span class="keyword">const</span> <a class="code" href="class_c_blob_result.html">CBlobResult</a>&amp; source)
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208         <span class="comment">// si ja són el mateix, no cal fer res</span>
<a name="l00209"></a>00209         <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;source)
<a name="l00210"></a>00210         {
<a name="l00211"></a>00211                 <span class="comment">// alliberem el conjunt de blobs antic</span>
<a name="l00212"></a>00212                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>(); i++ )
<a name="l00213"></a>00213                 {
<a name="l00214"></a>00214                         <span class="keyword">delete</span> <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>[i];
<a name="l00215"></a>00215                 }
<a name="l00216"></a>00216                 <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.clear();
<a name="l00217"></a>00217                 <span class="comment">// creem el nou a partir del passat com a paràmetre</span>
<a name="l00218"></a>00218                 <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a> = <a class="code" href="_blob_result_8h.html#5e6fa400c06a413a41414d2e8cea63c8">blob_vector</a>( source.<a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() );
<a name="l00219"></a>00219                 <span class="comment">// copiem els blobs de l'origen a l'actual</span>
<a name="l00220"></a>00220                 blob_vector::const_iterator pBlobsSrc = source.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin();
<a name="l00221"></a>00221                 blob_vector::iterator pBlobsDst = <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin();
<a name="l00222"></a>00222 
<a name="l00223"></a>00223                 <span class="keywordflow">while</span>( pBlobsSrc != source.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.end() )
<a name="l00224"></a>00224                 {
<a name="l00225"></a>00225                         <span class="comment">// no podem cridar a l'operador = ja que blob_vector és un </span>
<a name="l00226"></a>00226                         <span class="comment">// vector de CBlob*. Per tant, creem un blob nou a partir del</span>
<a name="l00227"></a>00227                         <span class="comment">// blob original</span>
<a name="l00228"></a>00228                         *pBlobsDst = <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>(**pBlobsSrc);
<a name="l00229"></a>00229                         pBlobsSrc++;
<a name="l00230"></a>00230                         pBlobsDst++;
<a name="l00231"></a>00231                 }
<a name="l00232"></a>00232         }
<a name="l00233"></a>00233         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00234"></a>00234 }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 
<a name="l00262"></a><a class="code" href="class_c_blob_result.html#3581c00554f77a0ae6150ec843f9d59d">00262</a> <a class="code" href="class_c_blob_result.html">CBlobResult</a> <a class="code" href="class_c_blob_result.html#3581c00554f77a0ae6150ec843f9d59d">CBlobResult::operator+</a>( <span class="keyword">const</span> <a class="code" href="class_c_blob_result.html">CBlobResult</a>&amp; source )
<a name="l00263"></a>00263 {       
<a name="l00264"></a>00264         <span class="comment">//creem el resultat a partir dels blobs actuals</span>
<a name="l00265"></a>00265         <a class="code" href="class_c_blob_result.html">CBlobResult</a> resultat( *<span class="keyword">this</span> );
<a name="l00266"></a>00266         
<a name="l00267"></a>00267         <span class="comment">// reservem memòria per als nous blobs</span>
<a name="l00268"></a>00268         resultat.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.resize( resultat.<a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() + source.<a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() );
<a name="l00269"></a>00269 
<a name="l00270"></a>00270         <span class="comment">// declarem els iterador per recòrrer els blobs d'origen i desti</span>
<a name="l00271"></a>00271         blob_vector::const_iterator pBlobsSrc = source.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin();
<a name="l00272"></a>00272         blob_vector::iterator pBlobsDst = resultat.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.end();
<a name="l00273"></a>00273 
<a name="l00274"></a>00274         <span class="comment">// insertem els blobs de l'origen a l'actual</span>
<a name="l00275"></a>00275         <span class="keywordflow">while</span>( pBlobsSrc != source.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.end() )
<a name="l00276"></a>00276         {
<a name="l00277"></a>00277                 pBlobsDst--;
<a name="l00278"></a>00278                 *pBlobsDst = <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>(**pBlobsSrc);
<a name="l00279"></a>00279                 pBlobsSrc++;
<a name="l00280"></a>00280         }
<a name="l00281"></a>00281         
<a name="l00282"></a>00282         <span class="keywordflow">return</span> resultat;
<a name="l00283"></a>00283 }
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="comment">/**************************************************************************</span>
<a name="l00286"></a>00286 <span class="comment">                Operacions / Operations</span>
<a name="l00287"></a>00287 <span class="comment">**************************************************************************/</span>
<a name="l00288"></a>00288 
<a name="l00301"></a><a class="code" href="class_c_blob_result.html#c9da5db13defb3e905532a0f34ea2d58">00301</a> <span class="keywordtype">void</span> <a class="code" href="class_c_blob_result.html#c9da5db13defb3e905532a0f34ea2d58">CBlobResult::AddBlob</a>( <a class="code" href="class_c_blob.html">CBlob</a> *blob )
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303         <span class="keywordflow">if</span>( blob != NULL )
<a name="l00304"></a>00304                 <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( blob ) );
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="preprocessor">#ifdef MATRIXCV_ACTIU</span>
<a name="l00309"></a>00309 <span class="preprocessor"></span>
<a name="l00336"></a><a class="code" href="class_c_blob_result.html#e8d257654607bfe9aacc4be7c0c228e7">00336</a> double_vector <a class="code" href="class_c_blob_result.html#e8d257654607bfe9aacc4be7c0c228e7">CBlobResult::GetResult</a>( <a class="code" href="class_c_operador_blob.html">funcio_calculBlob</a> *evaluador )<span class="keyword"> const</span>
<a name="l00337"></a>00337 <span class="keyword"></span>{
<a name="l00338"></a>00338         <span class="keywordflow">if</span>( <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() &lt;= 0 )
<a name="l00339"></a>00339         {
<a name="l00340"></a>00340                 <span class="keywordflow">return</span> double_vector();
<a name="l00341"></a>00341         }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343         <span class="comment">// definim el resultat</span>
<a name="l00344"></a>00344         double_vector result = double_vector( <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() );
<a name="l00345"></a>00345         <span class="comment">// i iteradors sobre els blobs i el resultat</span>
<a name="l00346"></a>00346         double_vector::iterator itResult = result.GetIterator();
<a name="l00347"></a>00347         blob_vector::const_iterator itBlobs = <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin();
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         <span class="comment">// avaluem la funció en tots els blobs</span>
<a name="l00350"></a>00350         <span class="keywordflow">while</span>( itBlobs != <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.end() )
<a name="l00351"></a>00351         {
<a name="l00352"></a>00352                 *itResult = (*evaluador)(**itBlobs);
<a name="l00353"></a>00353                 itBlobs++;
<a name="l00354"></a>00354                 itResult++;
<a name="l00355"></a>00355         }
<a name="l00356"></a>00356         <span class="keywordflow">return</span> result;
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 <span class="preprocessor">#endif</span>
<a name="l00359"></a>00359 <span class="preprocessor"></span>
<a name="l00386"></a><a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">00386</a> double_stl_vector <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">CBlobResult::GetSTLResult</a>( <a class="code" href="class_c_operador_blob.html">funcio_calculBlob</a> *evaluador )<span class="keyword"> const</span>
<a name="l00387"></a>00387 <span class="keyword"></span>{
<a name="l00388"></a>00388         <span class="keywordflow">if</span>( <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() &lt;= 0 )
<a name="l00389"></a>00389         {
<a name="l00390"></a>00390                 <span class="keywordflow">return</span> double_stl_vector();
<a name="l00391"></a>00391         }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393         <span class="comment">// definim el resultat</span>
<a name="l00394"></a>00394         double_stl_vector result = double_stl_vector( <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() );
<a name="l00395"></a>00395         <span class="comment">// i iteradors sobre els blobs i el resultat</span>
<a name="l00396"></a>00396         double_stl_vector::iterator itResult = result.begin();
<a name="l00397"></a>00397         blob_vector::const_iterator itBlobs = <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin();
<a name="l00398"></a>00398 
<a name="l00399"></a>00399         <span class="comment">// avaluem la funció en tots els blobs</span>
<a name="l00400"></a>00400         <span class="keywordflow">while</span>( itBlobs != <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.end() )
<a name="l00401"></a>00401         {
<a name="l00402"></a>00402                 *itResult = (*evaluador)(**itBlobs);
<a name="l00403"></a>00403                 itBlobs++;
<a name="l00404"></a>00404                 itResult++;
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406         <span class="keywordflow">return</span> result;
<a name="l00407"></a>00407 }
<a name="l00408"></a>00408 
<a name="l00435"></a><a class="code" href="class_c_blob_result.html#7f80058f8726468c0d074b8985c09d80">00435</a> <span class="keywordtype">double</span> <a class="code" href="class_c_blob_result.html#7f80058f8726468c0d074b8985c09d80">CBlobResult::GetNumber</a>( <span class="keywordtype">int</span> indexBlob, <a class="code" href="class_c_operador_blob.html">funcio_calculBlob</a> *evaluador )<span class="keyword"> const</span>
<a name="l00436"></a>00436 <span class="keyword"></span>{
<a name="l00437"></a>00437         <span class="keywordflow">if</span>( indexBlob &lt; 0 || indexBlob &gt;= <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() )
<a name="l00438"></a>00438                 <a class="code" href="class_c_blob_result.html#00b104a1bd3adc81191dd9e6c2ef493c">RaiseError</a>( <a class="code" href="_blob_result_8h.html#7e2768de82b7c95ae71061422ee13af9">EXCEPTION_BLOB_OUT_OF_BOUNDS</a> );
<a name="l00439"></a>00439         <span class="keywordflow">return</span> (*evaluador)( *<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>[indexBlob] );
<a name="l00440"></a>00440 }
<a name="l00441"></a>00441 
<a name="l00443"></a>00443 
<a name="l00495"></a><a class="code" href="class_c_blob_result.html#0240474a3c6f1885753a4d95bd441605">00495</a> <span class="keywordtype">void</span> <a class="code" href="class_c_blob_result.html#0240474a3c6f1885753a4d95bd441605">CBlobResult::Filter</a>(<a class="code" href="class_c_blob_result.html">CBlobResult</a> &amp;dst, 
<a name="l00496"></a>00496                                                  <span class="keywordtype">int</span> filterAction, 
<a name="l00497"></a>00497                                                  <a class="code" href="class_c_operador_blob.html">funcio_calculBlob</a> *evaluador, 
<a name="l00498"></a>00498                                                  <span class="keywordtype">int</span> condition, 
<a name="l00499"></a>00499                                                  <span class="keywordtype">double</span> lowLimit, <span class="keywordtype">double</span> highLimit <span class="comment">/*=0*/</span>)
<a name="l00500"></a>00500                                                         
<a name="l00501"></a>00501 {
<a name="l00502"></a>00502         <span class="keywordtype">int</span> i, numBlobs;
<a name="l00503"></a>00503         <span class="keywordtype">bool</span> resultavaluacio;
<a name="l00504"></a>00504         double_stl_vector avaluacioBlobs;
<a name="l00505"></a>00505         double_stl_vector::iterator itavaluacioBlobs;
<a name="l00506"></a>00506 
<a name="l00507"></a>00507         <span class="keywordflow">if</span>( <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() &lt;= 0 ) <span class="keywordflow">return</span>;
<a name="l00508"></a>00508         <span class="keywordflow">if</span>( !evaluador ) <span class="keywordflow">return</span>;
<a name="l00509"></a>00509         <span class="comment">//avaluem els blobs amb la funció pertinent     </span>
<a name="l00510"></a>00510         avaluacioBlobs = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>(evaluador);
<a name="l00511"></a>00511         itavaluacioBlobs = avaluacioBlobs.begin();
<a name="l00512"></a>00512         numBlobs = <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>();
<a name="l00513"></a>00513         <span class="keywordflow">switch</span>(condition)
<a name="l00514"></a>00514         {
<a name="l00515"></a>00515                 <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#1c28cf7a0934f9542901ea25ce37c318">B_EQUAL</a>:
<a name="l00516"></a>00516                         <span class="keywordflow">for</span>(i=0;i&lt;numBlobs;i++, itavaluacioBlobs++)
<a name="l00517"></a>00517                         {
<a name="l00518"></a>00518                                 resultavaluacio= *itavaluacioBlobs == lowLimit;
<a name="l00519"></a>00519                                 <span class="keywordflow">if</span>( ( resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#de04909606a5f7f4779c8bcc5042db79">B_INCLUDE</a> ) ||
<a name="l00520"></a>00520                                         ( !resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#902282f13f23a5541a2e6d01e3b604cc">B_EXCLUDE</a> ))
<a name="l00521"></a>00521                                 {
<a name="l00522"></a>00522                                         dst.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>( i ) ));
<a name="l00523"></a>00523                                 }                               
<a name="l00524"></a>00524                         }
<a name="l00525"></a>00525                         <span class="keywordflow">break</span>;
<a name="l00526"></a>00526                 <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#2c85ad2a17a4c28ad405f837155acddc">B_NOT_EQUAL</a>:
<a name="l00527"></a>00527                         <span class="keywordflow">for</span>(i=0;i&lt;numBlobs;i++, itavaluacioBlobs++)
<a name="l00528"></a>00528                         {
<a name="l00529"></a>00529                                 resultavaluacio = *itavaluacioBlobs != lowLimit;
<a name="l00530"></a>00530                                 <span class="keywordflow">if</span>( ( resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#de04909606a5f7f4779c8bcc5042db79">B_INCLUDE</a> ) ||
<a name="l00531"></a>00531                                         ( !resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#902282f13f23a5541a2e6d01e3b604cc">B_EXCLUDE</a> ))
<a name="l00532"></a>00532                                 {
<a name="l00533"></a>00533                                         dst.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>( i ) ));
<a name="l00534"></a>00534                                 }
<a name="l00535"></a>00535                         }
<a name="l00536"></a>00536                         <span class="keywordflow">break</span>;
<a name="l00537"></a>00537                 <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#3eed3f4e2ca8f385d9f976cf906c5650">B_GREATER</a>:
<a name="l00538"></a>00538                         <span class="keywordflow">for</span>(i=0;i&lt;numBlobs;i++, itavaluacioBlobs++)
<a name="l00539"></a>00539                         {
<a name="l00540"></a>00540                                 resultavaluacio= *itavaluacioBlobs &gt; lowLimit;
<a name="l00541"></a>00541                                 <span class="keywordflow">if</span>( ( resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#de04909606a5f7f4779c8bcc5042db79">B_INCLUDE</a> ) ||
<a name="l00542"></a>00542                                         ( !resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#902282f13f23a5541a2e6d01e3b604cc">B_EXCLUDE</a> ))
<a name="l00543"></a>00543                                 {
<a name="l00544"></a>00544                                         dst.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>( i ) ));
<a name="l00545"></a>00545                                 }
<a name="l00546"></a>00546                         }
<a name="l00547"></a>00547                         <span class="keywordflow">break</span>;
<a name="l00548"></a>00548                 <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#633be1c42afd3f718987f103b2aa54e4">B_LESS</a>:
<a name="l00549"></a>00549                         <span class="keywordflow">for</span>(i=0;i&lt;numBlobs;i++, itavaluacioBlobs++)
<a name="l00550"></a>00550                         {
<a name="l00551"></a>00551                                 resultavaluacio= *itavaluacioBlobs &lt; lowLimit;
<a name="l00552"></a>00552                                 <span class="keywordflow">if</span>( ( resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#de04909606a5f7f4779c8bcc5042db79">B_INCLUDE</a> ) ||
<a name="l00553"></a>00553                                         ( !resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#902282f13f23a5541a2e6d01e3b604cc">B_EXCLUDE</a> ))
<a name="l00554"></a>00554                                 {
<a name="l00555"></a>00555                                         dst.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>( i ) ));
<a name="l00556"></a>00556                                 }
<a name="l00557"></a>00557                         }
<a name="l00558"></a>00558                         <span class="keywordflow">break</span>;
<a name="l00559"></a>00559                 <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#dc318ac18e73e971515f5d9047220d58">B_GREATER_OR_EQUAL</a>:
<a name="l00560"></a>00560                         <span class="keywordflow">for</span>(i=0;i&lt;numBlobs;i++, itavaluacioBlobs++)
<a name="l00561"></a>00561                         {
<a name="l00562"></a>00562                                 resultavaluacio= *itavaluacioBlobs&gt;= lowLimit;
<a name="l00563"></a>00563                                 <span class="keywordflow">if</span>( ( resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#de04909606a5f7f4779c8bcc5042db79">B_INCLUDE</a> ) ||
<a name="l00564"></a>00564                                         ( !resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#902282f13f23a5541a2e6d01e3b604cc">B_EXCLUDE</a> ))
<a name="l00565"></a>00565                                 {
<a name="l00566"></a>00566                                         dst.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>( i ) ));
<a name="l00567"></a>00567                                 }
<a name="l00568"></a>00568                         }
<a name="l00569"></a>00569                         <span class="keywordflow">break</span>;
<a name="l00570"></a>00570                 <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#b6c8d24e25facba459f3871ed69c7d54">B_LESS_OR_EQUAL</a>:
<a name="l00571"></a>00571                         <span class="keywordflow">for</span>(i=0;i&lt;numBlobs;i++, itavaluacioBlobs++)
<a name="l00572"></a>00572                         {
<a name="l00573"></a>00573                                 resultavaluacio= *itavaluacioBlobs &lt;= lowLimit;
<a name="l00574"></a>00574                                 <span class="keywordflow">if</span>( ( resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#de04909606a5f7f4779c8bcc5042db79">B_INCLUDE</a> ) ||
<a name="l00575"></a>00575                                         ( !resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#902282f13f23a5541a2e6d01e3b604cc">B_EXCLUDE</a> ))
<a name="l00576"></a>00576                                 {
<a name="l00577"></a>00577                                         dst.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>( i ) ));
<a name="l00578"></a>00578                                 }
<a name="l00579"></a>00579                         }
<a name="l00580"></a>00580                         <span class="keywordflow">break</span>;
<a name="l00581"></a>00581                 <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#be72a81ef6be6a277cc5795a65d390f2">B_INSIDE</a>:
<a name="l00582"></a>00582                         <span class="keywordflow">for</span>(i=0;i&lt;numBlobs;i++, itavaluacioBlobs++)
<a name="l00583"></a>00583                         {
<a name="l00584"></a>00584                                 resultavaluacio=( *itavaluacioBlobs &gt;= lowLimit) &amp;&amp; ( *itavaluacioBlobs &lt;= highLimit); 
<a name="l00585"></a>00585                                 <span class="keywordflow">if</span>( ( resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#de04909606a5f7f4779c8bcc5042db79">B_INCLUDE</a> ) ||
<a name="l00586"></a>00586                                         ( !resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#902282f13f23a5541a2e6d01e3b604cc">B_EXCLUDE</a> ))
<a name="l00587"></a>00587                                 {
<a name="l00588"></a>00588                                         dst.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>( i ) ));
<a name="l00589"></a>00589                                 }
<a name="l00590"></a>00590                         }
<a name="l00591"></a>00591                         <span class="keywordflow">break</span>;
<a name="l00592"></a>00592                 <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#c3627839543a57f32f6c16bdbfa376ad">B_OUTSIDE</a>:
<a name="l00593"></a>00593                         <span class="keywordflow">for</span>(i=0;i&lt;numBlobs;i++, itavaluacioBlobs++)
<a name="l00594"></a>00594                         {
<a name="l00595"></a>00595                                 resultavaluacio=( *itavaluacioBlobs &lt; lowLimit) || ( *itavaluacioBlobs &gt; highLimit); 
<a name="l00596"></a>00596                                 <span class="keywordflow">if</span>( ( resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#de04909606a5f7f4779c8bcc5042db79">B_INCLUDE</a> ) ||
<a name="l00597"></a>00597                                         ( !resultavaluacio &amp;&amp; filterAction == <a class="code" href="_blob_result_8h.html#902282f13f23a5541a2e6d01e3b604cc">B_EXCLUDE</a> ))
<a name="l00598"></a>00598                                 {
<a name="l00599"></a>00599                                         dst.<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.push_back( <span class="keyword">new</span> <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>( i ) ));
<a name="l00600"></a>00600                                 }
<a name="l00601"></a>00601                         }
<a name="l00602"></a>00602                         <span class="keywordflow">break</span>;
<a name="l00603"></a>00603         }
<a name="l00604"></a>00604 
<a name="l00605"></a>00605 
<a name="l00606"></a>00606         <span class="comment">// en cas de voler filtrar un CBlobResult i deixar-ho en el mateix CBlobResult</span>
<a name="l00607"></a>00607         <span class="comment">// ( operacio inline )</span>
<a name="l00608"></a>00608         <span class="keywordflow">if</span>( &amp;dst == <span class="keyword">this</span> ) 
<a name="l00609"></a>00609         {
<a name="l00610"></a>00610                 <span class="comment">// esborrem els primers blobs ( que són els originals )</span>
<a name="l00611"></a>00611                 <span class="comment">// ja que els tindrem replicats al final si passen el filtre</span>
<a name="l00612"></a>00612                 blob_vector::iterator itBlobs = <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin();
<a name="l00613"></a>00613                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; numBlobs; i++ )
<a name="l00614"></a>00614                 {
<a name="l00615"></a>00615                         <span class="keyword">delete</span> *itBlobs;
<a name="l00616"></a>00616                         itBlobs++;
<a name="l00617"></a>00617                 }
<a name="l00618"></a>00618                 <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.erase( <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin(), itBlobs );
<a name="l00619"></a>00619         }
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 
<a name="l00634"></a>00634 <span class="comment">/*</span>
<a name="l00635"></a>00635 <span class="comment">- FUNCTION: GetBlob</span>
<a name="l00636"></a>00636 <span class="comment">- FUNCTIONALITY: Gets the n-th blob (without ordering the blobs)</span>
<a name="l00637"></a>00637 <span class="comment">- PARAMETERS:</span>
<a name="l00638"></a>00638 <span class="comment">        - indexblob: index in the blob array</span>
<a name="l00639"></a>00639 <span class="comment">- RESULT:</span>
<a name="l00640"></a>00640 <span class="comment">- RESTRICTIONS:</span>
<a name="l00641"></a>00641 <span class="comment">- AUTHOR: Ricard Borràs</span>
<a name="l00642"></a>00642 <span class="comment">- CREATION DATE: 25-05-2005.</span>
<a name="l00643"></a>00643 <span class="comment">- MODIFICATION: Date. Author. Description.</span>
<a name="l00644"></a>00644 <span class="comment">*/</span>
<a name="l00645"></a><a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">00645</a> <a class="code" href="class_c_blob.html">CBlob</a> <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">CBlobResult::GetBlob</a>(<span class="keywordtype">int</span> indexblob)<span class="keyword"> const</span>
<a name="l00646"></a>00646 <span class="keyword"></span>{       
<a name="l00647"></a>00647         <span class="keywordflow">if</span>( indexblob &lt; 0 || indexblob &gt;= <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() )
<a name="l00648"></a>00648                 <a class="code" href="class_c_blob_result.html#00b104a1bd3adc81191dd9e6c2ef493c">RaiseError</a>( <a class="code" href="_blob_result_8h.html#7e2768de82b7c95ae71061422ee13af9">EXCEPTION_BLOB_OUT_OF_BOUNDS</a> );
<a name="l00649"></a>00649 
<a name="l00650"></a>00650         <span class="keywordflow">return</span> *<a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>[indexblob];
<a name="l00651"></a>00651 }
<a name="l00652"></a><a class="code" href="class_c_blob_result.html#6e11d8120572fe14262fe419747c3084">00652</a> <a class="code" href="class_c_blob.html">CBlob</a> *<a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">CBlobResult::GetBlob</a>(<span class="keywordtype">int</span> indexblob)
<a name="l00653"></a>00653 {       
<a name="l00654"></a>00654         <span class="keywordflow">if</span>( indexblob &lt; 0 || indexblob &gt;= <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() )
<a name="l00655"></a>00655                 <a class="code" href="class_c_blob_result.html#00b104a1bd3adc81191dd9e6c2ef493c">RaiseError</a>( <a class="code" href="_blob_result_8h.html#7e2768de82b7c95ae71061422ee13af9">EXCEPTION_BLOB_OUT_OF_BOUNDS</a> );
<a name="l00656"></a>00656 
<a name="l00657"></a>00657         <span class="keywordflow">return</span> <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>[indexblob];
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00677"></a>00677 <span class="comment">/*</span>
<a name="l00678"></a>00678 <span class="comment">- FUNCTION: GetNthBlob</span>
<a name="l00679"></a>00679 <span class="comment">- FUNCTIONALITY: Gets the n-th blob ordering first the blobs with some criteria</span>
<a name="l00680"></a>00680 <span class="comment">- PARAMETERS:</span>
<a name="l00681"></a>00681 <span class="comment">        - criteri: criteria to order the blob array</span>
<a name="l00682"></a>00682 <span class="comment">        - nBlob: index of the returned blob in the ordered blob array</span>
<a name="l00683"></a>00683 <span class="comment">        - dst: where to store the result</span>
<a name="l00684"></a>00684 <span class="comment">- RESULT:</span>
<a name="l00685"></a>00685 <span class="comment">- RESTRICTIONS:</span>
<a name="l00686"></a>00686 <span class="comment">- AUTHOR: Ricard Borràs</span>
<a name="l00687"></a>00687 <span class="comment">- CREATION DATE: 25-05-2005.</span>
<a name="l00688"></a>00688 <span class="comment">- MODIFICATION: Date. Author. Description.</span>
<a name="l00689"></a>00689 <span class="comment">*/</span>
<a name="l00690"></a><a class="code" href="class_c_blob_result.html#7e7929a4ae93967c14eeb958ed64d848">00690</a> <span class="keywordtype">void</span> <a class="code" href="class_c_blob_result.html#7e7929a4ae93967c14eeb958ed64d848">CBlobResult::GetNthBlob</a>( <a class="code" href="class_c_operador_blob.html">funcio_calculBlob</a> *criteri, <span class="keywordtype">int</span> nBlob, <a class="code" href="class_c_blob.html">CBlob</a> &amp;dst )<span class="keyword"> const</span>
<a name="l00691"></a>00691 <span class="keyword"></span>{
<a name="l00692"></a>00692         <span class="comment">// verifiquem que no estem accedint fora el vector de blobs</span>
<a name="l00693"></a>00693         <span class="keywordflow">if</span>( nBlob &lt; 0 || nBlob &gt;= <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() )
<a name="l00694"></a>00694         {
<a name="l00695"></a>00695                 <span class="comment">//RaiseError( EXCEPTION_BLOB_OUT_OF_BOUNDS );</span>
<a name="l00696"></a>00696                 dst = <a class="code" href="class_c_blob.html">CBlob</a>();
<a name="l00697"></a>00697                 <span class="keywordflow">return</span>;
<a name="l00698"></a>00698         }
<a name="l00699"></a>00699 
<a name="l00700"></a>00700         double_stl_vector avaluacioBlobs, avaluacioBlobsOrdenat;
<a name="l00701"></a>00701         <span class="keywordtype">double</span> valorEnessim;
<a name="l00702"></a>00702 
<a name="l00703"></a>00703         <span class="comment">//avaluem els blobs amb la funció pertinent     </span>
<a name="l00704"></a>00704         avaluacioBlobs = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>(criteri);
<a name="l00705"></a>00705 
<a name="l00706"></a>00706         avaluacioBlobsOrdenat = double_stl_vector( <a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>() );
<a name="l00707"></a>00707 
<a name="l00708"></a>00708         <span class="comment">// obtenim els nBlob primers resultats (en ordre descendent)</span>
<a name="l00709"></a>00709         std::partial_sort_copy( avaluacioBlobs.begin(), 
<a name="l00710"></a>00710                                                     avaluacioBlobs.end(),
<a name="l00711"></a>00711                                                     avaluacioBlobsOrdenat.begin(), 
<a name="l00712"></a>00712                                                     avaluacioBlobsOrdenat.end(),
<a name="l00713"></a>00713                                                     std::greater&lt;double&gt;() );
<a name="l00714"></a>00714 
<a name="l00715"></a>00715         valorEnessim = avaluacioBlobsOrdenat[nBlob];
<a name="l00716"></a>00716 
<a name="l00717"></a>00717         <span class="comment">// busquem el primer blob que té el valor n-ssim</span>
<a name="l00718"></a>00718         double_stl_vector::const_iterator itAvaluacio = avaluacioBlobs.begin();
<a name="l00719"></a>00719 
<a name="l00720"></a>00720         <span class="keywordtype">bool</span> trobatBlob = <span class="keyword">false</span>;
<a name="l00721"></a>00721         <span class="keywordtype">int</span> indexBlob = 0;
<a name="l00722"></a>00722         <span class="keywordflow">while</span>( itAvaluacio != avaluacioBlobs.end() &amp;&amp; !trobatBlob )
<a name="l00723"></a>00723         {
<a name="l00724"></a>00724                 <span class="keywordflow">if</span>( *itAvaluacio == valorEnessim )
<a name="l00725"></a>00725                 {
<a name="l00726"></a>00726                         trobatBlob = <span class="keyword">true</span>;
<a name="l00727"></a>00727                         dst = <a class="code" href="class_c_blob.html">CBlob</a>( <a class="code" href="class_c_blob_result.html#1c9b86a3d2a6ec175bdf3f6f7c211521">GetBlob</a>(indexBlob));
<a name="l00728"></a>00728                 }
<a name="l00729"></a>00729                 itAvaluacio++;
<a name="l00730"></a>00730                 indexBlob++;
<a name="l00731"></a>00731         }
<a name="l00732"></a>00732 }
<a name="l00733"></a>00733 
<a name="l00745"></a>00745 <span class="comment">/*</span>
<a name="l00746"></a>00746 <span class="comment">- FUNCTION: ClearBlobs</span>
<a name="l00747"></a>00747 <span class="comment">- FUNCTIONALITY: Clears all the blobs from the object and releases all its memory</span>
<a name="l00748"></a>00748 <span class="comment">- PARAMETERS:</span>
<a name="l00749"></a>00749 <span class="comment">- RESULT:</span>
<a name="l00750"></a>00750 <span class="comment">- RESTRICTIONS:</span>
<a name="l00751"></a>00751 <span class="comment">- AUTHOR: Ricard Borràs</span>
<a name="l00752"></a>00752 <span class="comment">- CREATION DATE: 25-05-2005.</span>
<a name="l00753"></a>00753 <span class="comment">- MODIFICATION: Date. Author. Description.</span>
<a name="l00754"></a>00754 <span class="comment">*/</span>
<a name="l00755"></a><a class="code" href="class_c_blob_result.html#a926243bae6148e765f8a4055ef42ce0">00755</a> <span class="keywordtype">void</span> <a class="code" href="class_c_blob_result.html#a926243bae6148e765f8a4055ef42ce0">CBlobResult::ClearBlobs</a>()
<a name="l00756"></a>00756 {
<a name="l00757"></a>00757         <span class="comment">/*for( int i = 0; i &lt; GetNumBlobs(); i++ )</span>
<a name="l00758"></a>00758 <span class="comment">        {</span>
<a name="l00759"></a>00759 <span class="comment">                delete m_blobs[i];</span>
<a name="l00760"></a>00760 <span class="comment">        }*/</span>
<a name="l00761"></a>00761         blob_vector::iterator itBlobs = <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.begin();
<a name="l00762"></a>00762         <span class="keywordflow">while</span>( itBlobs != <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.end() )
<a name="l00763"></a>00763         {
<a name="l00764"></a>00764                 <span class="keyword">delete</span> *itBlobs;
<a name="l00765"></a>00765                 itBlobs++;
<a name="l00766"></a>00766         }
<a name="l00767"></a>00767 
<a name="l00768"></a>00768         <a class="code" href="class_c_blob_result.html#bbca967e6a67d286519ce83421819633">m_blobs</a>.clear();
<a name="l00769"></a>00769 }
<a name="l00770"></a>00770 
<a name="l00784"></a>00784 <span class="comment">/*</span>
<a name="l00785"></a>00785 <span class="comment">- FUNCTION: RaiseError</span>
<a name="l00786"></a>00786 <span class="comment">- FUNCTIONALITY: Error handling function</span>
<a name="l00787"></a>00787 <span class="comment">- PARAMETERS:</span>
<a name="l00788"></a>00788 <span class="comment">        - errorCode: reason of the error</span>
<a name="l00789"></a>00789 <span class="comment">- RESULT:</span>
<a name="l00790"></a>00790 <span class="comment">        - in _DEBUG version, shows a message box with the error. In release is silent.</span>
<a name="l00791"></a>00791 <span class="comment">          In both cases throws an exception with the error.</span>
<a name="l00792"></a>00792 <span class="comment">- RESTRICTIONS:</span>
<a name="l00793"></a>00793 <span class="comment">- AUTHOR: Ricard Borràs</span>
<a name="l00794"></a>00794 <span class="comment">- CREATION DATE: 25-05-2005.</span>
<a name="l00795"></a>00795 <span class="comment">- MODIFICATION: Date. Author. Description.</span>
<a name="l00796"></a>00796 <span class="comment">*/</span>
<a name="l00797"></a><a class="code" href="class_c_blob_result.html#00b104a1bd3adc81191dd9e6c2ef493c">00797</a> <span class="keywordtype">void</span> <a class="code" href="class_c_blob_result.html#00b104a1bd3adc81191dd9e6c2ef493c">CBlobResult::RaiseError</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> errorCode)<span class="keyword"> const</span>
<a name="l00798"></a>00798 <span class="keyword"></span>{
<a name="l00799"></a>00799         <span class="comment">// estem en mode debug?</span>
<a name="l00800"></a>00800 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00801"></a>00801 <span class="preprocessor"></span>        CString msg, format = <span class="stringliteral">"Error en CBlobResult: %s"</span>;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803         <span class="keywordflow">switch</span> (errorCode)
<a name="l00804"></a>00804         {
<a name="l00805"></a>00805         <span class="keywordflow">case</span> <a class="code" href="_blob_result_8h.html#7e2768de82b7c95ae71061422ee13af9">EXCEPTION_BLOB_OUT_OF_BOUNDS</a>:
<a name="l00806"></a>00806                 msg.Format(format, <span class="stringliteral">"Intentant accedir a un blob no existent"</span>);
<a name="l00807"></a>00807                 <span class="keywordflow">break</span>;
<a name="l00808"></a>00808         <span class="keywordflow">default</span>:
<a name="l00809"></a>00809                 msg.Format(format, <span class="stringliteral">"Codi d'error desconegut"</span>);
<a name="l00810"></a>00810                 <span class="keywordflow">break</span>;
<a name="l00811"></a>00811         }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813         AfxMessageBox(msg);
<a name="l00814"></a>00814 
<a name="l00815"></a>00815 <span class="preprocessor">#endif</span>
<a name="l00816"></a>00816 <span class="preprocessor"></span>        <span class="keywordflow">throw</span> errorCode;
<a name="l00817"></a>00817 }
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="comment">/**************************************************************************</span>
<a name="l00822"></a>00822 <span class="comment">                Auxiliars / Auxiliary functions</span>
<a name="l00823"></a>00823 <span class="comment">**************************************************************************/</span>
<a name="l00824"></a>00824 
<a name="l00825"></a>00825 
<a name="l00838"></a>00838 <span class="comment">/*</span>
<a name="l00839"></a>00839 <span class="comment">- FUNCTION: PrintBlobs</span>
<a name="l00840"></a>00840 <span class="comment">- FUNCTIONALITY: Prints some blob features in an ASCII file</span>
<a name="l00841"></a>00841 <span class="comment">- PARAMETERS:</span>
<a name="l00842"></a>00842 <span class="comment">        - nom_fitxer: full path + filename to generate</span>
<a name="l00843"></a>00843 <span class="comment">- RESULT:</span>
<a name="l00844"></a>00844 <span class="comment">- RESTRICTIONS:</span>
<a name="l00845"></a>00845 <span class="comment">- AUTHOR: Ricard Borràs</span>
<a name="l00846"></a>00846 <span class="comment">- CREATION DATE: 25-05-2005.</span>
<a name="l00847"></a>00847 <span class="comment">- MODIFICATION: Date. Author. Description.</span>
<a name="l00848"></a>00848 <span class="comment">*/</span>
<a name="l00849"></a><a class="code" href="class_c_blob_result.html#39df81e0a49e4859c9b963e23f9f55df">00849</a> <span class="keywordtype">void</span> <a class="code" href="class_c_blob_result.html#39df81e0a49e4859c9b963e23f9f55df">CBlobResult::PrintBlobs</a>( <span class="keywordtype">char</span> *nom_fitxer )<span class="keyword"> const</span>
<a name="l00850"></a>00850 <span class="keyword"></span>{
<a name="l00851"></a>00851         double_stl_vector area, <span class="comment">/*perimetre,*/</span> exterior, mitjana, compacitat, longitud, 
<a name="l00852"></a>00852                                           externPerimeter, perimetreConvex;
<a name="l00853"></a>00853         double_vector perimetre;
<a name="l00854"></a>00854         <span class="keywordtype">int</span> i;
<a name="l00855"></a>00855         FILE *fitxer_sortida;
<a name="l00856"></a>00856 
<a name="l00857"></a>00857         area      = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>( <a class="code" href="class_c_blob_get_area.html">CBlobGetArea</a>());
<a name="l00858"></a>00858         <span class="comment">//perimetre = GetSTLResult( CBlobGetPerimeter());</span>
<a name="l00859"></a>00859         perimetre = <a class="code" href="class_c_blob_result.html#e8d257654607bfe9aacc4be7c0c228e7">GetResult</a>( <a class="code" href="class_c_blob_get_perimeter.html">CBlobGetPerimeter</a>());
<a name="l00860"></a>00860         exterior  = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>( <a class="code" href="class_c_blob_get_exterior.html">CBlobGetExterior</a>());
<a name="l00861"></a>00861         mitjana   = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>( <a class="code" href="class_c_blob_get_mean.html">CBlobGetMean</a>());
<a name="l00862"></a>00862         compacitat = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>(<a class="code" href="class_c_blob_get_compactness.html">CBlobGetCompactness</a>());
<a name="l00863"></a>00863         longitud  = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>( <a class="code" href="class_c_blob_get_length.html">CBlobGetLength</a>());
<a name="l00864"></a>00864         externPerimeter = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>( <a class="code" href="class_c_blob_get_extern_perimeter.html">CBlobGetExternPerimeter</a>());
<a name="l00865"></a>00865         perimetreConvex = <a class="code" href="class_c_blob_result.html#fd0358f1102aac1f4b1a3175c50f006f">GetSTLResult</a>( <a class="code" href="class_c_blob_get_hull_perimeter.html">CBlobGetHullPerimeter</a>());
<a name="l00866"></a>00866 
<a name="l00867"></a>00867         fitxer_sortida = fopen( nom_fitxer, <span class="stringliteral">"w"</span> );
<a name="l00868"></a>00868 
<a name="l00869"></a>00869         <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="class_c_blob_result.html#a563a89cbc5ce56126c6ce34be902657">GetNumBlobs</a>(); i++)
<a name="l00870"></a>00870         {
<a name="l00871"></a>00871                 fprintf( fitxer_sortida, <span class="stringliteral">"blob %d -&gt;\t a=%7.0f\t p=%8.2f (%8.2f extern)\t pconvex=%8.2f\t ext=%.0f\t m=%7.2f\t c=%3.2f\t l=%8.2f\n"</span>,
<a name="l00872"></a>00872                                  i, area[i], perimetre(i), externPerimeter[i], perimetreConvex[i], exterior[i], mitjana[i], compacitat[i], longitud[i] );
<a name="l00873"></a>00873         }
<a name="l00874"></a>00874         fclose( fitxer_sortida );
<a name="l00875"></a>00875 
<a name="l00876"></a>00876 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Nov 13 13:32:49 2006 for cvBlobsLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
